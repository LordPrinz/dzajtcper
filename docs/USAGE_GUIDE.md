# TCP CWND Monitor - Przewodnik u≈ºytkownika

## Opis
TCP CWND Monitor to zaawansowane narzƒôdzie do monitorowania okna przesy≈Çania (congestion window) z algorytmu Cubic bezpo≈õrednio z jƒÖdra Linux za pomocƒÖ eBPF. Program oferuje unified command interface przez single `./run.sh` script z automatycznym zarzƒÖdzaniem uprawnieniami.

## Wymagania systemowe
- **System**: Linux z jƒÖdrem obs≈ÇugujƒÖcym eBPF (>= 4.7)
- **Pakiety systemowe**: `python3-bpfcc` (dla eBPF)
- **Uprawnienia**: Automatycznie obs≈Çugiwane przez `./run.sh`
- **Python**: Wersja 3.7+

## Instalacja i konfiguracja

### 1. Szybka instalacja
```bash
# Wykonaj skrypt instalacyjny
./install.sh
```

### 2. Rƒôczna instalacja
```bash
# Instalacja pakiet√≥w systemowych
sudo apt update
sudo apt install python3-bpfcc python3-venv python3-pip
sudo apt install python3-pandas python3-matplotlib python3-seaborn python3-plotly python3-numpy

# Setup projektu
chmod +x *.py *.sh
```

## Sposoby uruchamiania

### üöÄ METODA 1: Szybki start (Rekomendowana)
Wszystko w jednej komendzie - monitoring + analiza + wykresy:

```bash
# Podstawowe u≈ºycie (60 sekund monitoring)
./run.sh quick

# Monitoring przez okre≈õlony czas
./run.sh quick --duration 30

# Przyk≈Çady r√≥≈ºnych czas√≥w
./run.sh quick --duration 15   # 15 sekund
./run.sh quick --duration 120  # 2 minuty
```

**Wynik**: Program automatycznie:
- Zbiera dane przez okre≈õlony czas (z automatycznym sudo)
- Analizuje zebranƒÖ zawarto≈õƒá (z automatycznym zarzƒÖdzaniem uprawnieniami)
- Generuje wykresy w session directory
- Zapisuje dane w out/session_TIMESTAMP/

### üìä METODA 2: Etapowe podej≈õcie

#### Krok 1: Monitoring
```bash
# Podstawowy monitoring (60 sekund)
./run.sh monitor

# Monitoring z okre≈õlonym czasem
./run.sh monitor --duration 30
```

#### Krok 2: Analiza zebranych danych
```bash
# Analiza najnowszej sesji
./run.sh analyze

# Analiza konkretnej sesji
./run.sh analyze session_20250911_143025

# Analiza z filtrowaniem
./run.sh analyze --pid 1234
./run.sh analyze --saddr 192.168.1.100
./run.sh analyze --cwnd-min 50 --cwnd-max 200
```

### ÔøΩ METODA 3: Comprehensive reporting
Generowanie komprehensywnych raport√≥w:

```bash
# Raport z najnowszej sesji
./run.sh report

# Raport z konkretnej sesji
./run.sh report session_20250911_143025

# Raport z custom nazwƒÖ
./run.sh report session_20250911_143025 custom_analysis.html
```

### ÔøΩ METODA 4: Live monitoring
Monitoring na ≈ºywo z okre≈õlonym czasem:

```bash
# Live monitoring przez 60 sekund
./run.sh live --duration 60

### üîß METODA 5: ZarzƒÖdzanie sesjami

#### Lista sesji
```bash
# Poka≈º wszystkie dostƒôpne sesje
./run.sh list
```

#### Czyszczenie
```bash
# Usu≈Ñ puste sesje
./run.sh clean
```

## ZarzƒÖdzanie sesjami

### Struktura unified session directory
```
out/
‚îú‚îÄ‚îÄ session_20250911_143025/
‚îÇ   ‚îú‚îÄ‚îÄ cwnd_log.csv                         # üìä Raw TCP data
‚îÇ   ‚îú‚îÄ‚îÄ analysis_20250911_143225_timeline.png       # üìà First analysis  
‚îÇ   ‚îú‚îÄ‚îÄ analysis_20250911_143225_connections.png    # üîó Connection analysis
‚îÇ   ‚îú‚îÄ‚îÄ analysis_20250911_143225_heatmap.png        # üå°Ô∏è Heatmap
‚îÇ   ‚îú‚îÄ‚îÄ analysis_20250911_143225_timeline_interactive.html  # üéØ Interactive
‚îÇ   ‚îî‚îÄ‚îÄ analysis_20250911_145030_*                  # üìà Second analysis (filtered)
‚îú‚îÄ‚îÄ session_20250911_145123/
‚îî‚îÄ‚îÄ session_20250911_150245/
```

### Session commands
```bash
# Lista wszystkich sesji
./run.sh list

# Czyszczenie pustych sesji  
./run.sh clean

# Analiza konkretnej sesji
./run.sh analyze session_20250911_143025

# Raport z konkretnej sesji
./run.sh report session_20250911_143025
```

## Rodzaje generowanych wykres√≥w

1. **Timeline** (`*_timeline.png`) - Zmiana CWND w czasie dla ka≈ºdego po≈ÇƒÖczenia
2. **Connections** (`*_connections.png`) - Analiza per po≈ÇƒÖczenie
3. **Heatmap** (`*_heatmap.png`) - Mapa ciep≈Ça aktywno≈õci  
4. **Overview** (`*_overview.png`) - Statystyki podsumowujƒÖce
5. **Interactive** (`*_timeline_interactive.html`) - Interaktywny wykres w przeglƒÖdarce

## Przyk≈Çady u≈ºycia

### Scenariusz 1: Szybka diagnoza
```bash
# 30 sekund monitoringu z automatycznƒÖ analizƒÖ
./run.sh quick --duration 30
# Sprawd≈∫ wyniki w out/session_*/
```

### Scenariusz 2: D≈Çugi monitoring konkretnego procesu
```bash
# Zbieranie danych przez 10 minut
./run.sh monitor --duration 600

# Analiza z filtrowaniem dla konkretnego PID
./run.sh analyze --pid 1234 --charts timeline connections
```

### Scenariusz 3: Comprehensive analysis z raportem
```bash
# Monitor i generate comprehensive report
./run.sh monitor --duration 300
./run.sh report  # Generate HTML report
```

### Scenariusz 4: Analiza po≈ÇƒÖcze≈Ñ sieciowych
```bash
# Monitor specific network traffic
./run.sh monitor --duration 120

# Analyze specific ports
./run.sh analyze --dport 443 --charts timeline heatmap
```

## Opcje filtrowania

### Filtry dostƒôpne w analizie:
- `--pid PID` - Konkretny proces
- `--saddr IP` - ≈πr√≥d≈Çowy adres IP  
- `--daddr IP` - Docelowy adres IP
- `--sport PORT` - Port ≈∫r√≥d≈Çowy
- `--dport PORT` - Port docelowy
- `--cwnd-min VALUE` - Minimalna warto≈õƒá CWND
- `--cwnd-max VALUE` - Maksymalna warto≈õƒá CWND

### Przyk≈Çady filtrowania:
```bash
# Tylko SSH connections (port 22)
./run.sh analyze --dport 22

# CWND powy≈ºej 50
./run.sh analyze --cwnd-min 50

# Konkretny host
# Kombinowane filtry
./run.sh analyze --dport 443 --cwnd-min 20 --charts timeline connections
```

## RozwiƒÖzywanie problem√≥w

### Problem: Permission conflicts
```bash
# run.sh automatycznie obs≈Çuguje uprawnienia
./run.sh monitor --duration 30  # Auto-sudo + permission fixing
./run.sh analyze                # Auto permission handling
```

### Problem: "ModuleNotFoundError: No module named 'pandas'"
```bash
# Reinstaluj systemowe pakiety Python
sudo apt install python3-pandas python3-matplotlib python3-seaborn python3-plotly

# Lub u≈ºyj installation script
./install.sh
```

### Problem: "No data collected"
```bash
# Sprawd≈∫ czy masz aktywne po≈ÇƒÖczenia TCP
ss -tuln

# Spr√≥buj d≈Çu≈ºszego czasu monitorowania
./run.sh monitor --duration 120
```

### Problem: Puste sesje
```bash
# Wyczy≈õƒá puste sesje
./run.sh clean

# Sprawd≈∫ dostƒôpne sesje
./run.sh list
```

## Interpretacja wynik√≥w

### Warto≈õci CWND
- **Ma≈Çe warto≈õci (1-10)**: PoczƒÖtek po≈ÇƒÖczenia lub po stracie pakiet√≥w
- **≈örednie warto≈õci (10-100)**: Normalna praca algorytmu Cubic  
- **Du≈ºe warto≈õci (>100)**: Optymalne wykorzystanie przepustowo≈õci

### Wzorce w wykresach
- **Wzrost pi≈Çokszta≈Çtny**: Charakterystyczny dla Cubic TCP
- **Nag≈Çe spadki**: Wykryte straty pakiet√≥w
- **Plateau**: Ograniczenie przez odbiorcƒô (rwnd) lub sieƒá

## Wskaz√≥wki optymalizacji

### Dla d≈Çugotrwa≈Çego monitoringu:
```bash
# U≈ºyj wiƒôkszych interwa≈Ç√≥w przy d≈Çugim czasie
./run.sh monitor --duration 3600  # 1 godzina
```

### Dla analizy wydajno≈õci:
```bash
# Skup siƒô na po≈ÇƒÖczeniach o wysokim CWND
./run.sh analyze --cwnd-min 50 --charts timeline

# Generate comprehensive report
./run.sh report
```

### Dla debugowania sieci:
```bash
# Live monitoring okre≈õlonego czasu
./run.sh live --duration 300
```

## Struktura danych wyj≈õciowych

### Format CSV:
```
timestamp,pid,saddr,sport,daddr,dport,cwnd,connection
2025-01-01T12:00:00.123456,1234,192.168.1.1,12345,192.168.1.2,80,42,192.168.1.1:12345->192.168.1.2:80
```

### Kolumny:
- `timestamp`: Czas zdarzenia (ISO format)
- `pid`: ID procesu (0 dla jƒÖdra)
- `saddr`: ≈πr√≥d≈Çowy adres IP
- `sport`: Port ≈∫r√≥d≈Çowy  
- `daddr`: Docelowy adres IP
- `dport`: Port docelowy
- `cwnd`: Warto≈õƒá congestion window
- `connection`: String identyfikujƒÖcy po≈ÇƒÖczenie

## Dostƒôpne komendy - podsumowanie

| Komenda | Opis | Przyk≈Çad |
|---------|------|----------|
| `./run.sh monitor` | eBPF monitoring | `./run.sh monitor --duration 60` |
| `./run.sh analyze` | Analiza danych | `./run.sh analyze --dport 443` |
| `./run.sh live` | Live monitoring | `./run.sh live --duration 60` |
| `./run.sh quick` | Monitor + analiza | `./run.sh quick --duration 30` |
| `./run.sh report` | Comprehensive report | `./run.sh report` |
| `./run.sh list` | Lista sesji | `./run.sh list` |
| `./run.sh clean` | Usu≈Ñ puste sesje | `./run.sh clean` |

---

## Przyk≈Çad kompletnego workflow

```bash
# 1. Szybka analiza (najprostsze)
./run.sh quick --duration 60

# 2. Sprawdzenie wynik√≥w w session directory
./run.sh list

# 3. Generate comprehensive report
./run.sh report

# 4. Otworzenie interaktywnego wykresu
firefox out/session_*/*_interactive.html

# 5. Dla g≈Çƒôbszej analizy konkretnego procesu
./run.sh monitor --duration 300
./run.sh analyze --pid $(pgrep nginx) --charts timeline connections

# 6. Live monitoring podczas test√≥w
./run.sh live --duration 180
# Uruchom swoje testy sieciowe w innym terminalu
```
```

## RozwiƒÖzywanie problem√≥w

### Problem: "Permission denied" lub "Operation not permitted"
```bash
# Upewnij siƒô, ≈ºe u≈ºywasz sudo
sudo ./run.sh quick --duration 30
```

### Problem: "ModuleNotFoundError: No module named 'pandas'"
```bash
# Reinstaluj systemowe pakiety Python
sudo apt install python3-pandas python3-matplotlib python3-seaborn python3-plotly
```

### Problem: "No data collected"
```bash
# Sprawd≈∫ czy masz aktywne po≈ÇƒÖczenia TCP
ss -tuln

# Spr√≥buj d≈Çu≈ºszego czasu monitorowania
sudo ./run.sh quick --duration 60
```

### Problem: Brak wykres√≥w
```bash
# Sprawd≈∫ czy istniejƒÖ sesje z wynikami
ls -la out/session_*/

# Sprawd≈∫ czy w sesji sƒÖ wygenerowane wykresy
ls -la out/session_*/*.html out/session_*/*.png
```

## Interpretacja wynik√≥w

### Warto≈õci CWND
- **Ma≈Çe warto≈õci (1-10)**: PoczƒÖtek po≈ÇƒÖczenia lub po stracie pakiet√≥w
- **≈örednie warto≈õci (10-100)**: Normalna praca algorytmu Cubic  
- **Du≈ºe warto≈õci (>100)**: Optymalne wykorzystanie przepustowo≈õci

### Wzorce w wykresach
- **Wzrost pi≈Çokszta≈Çtny**: Charakterystyczny dla Cubic TCP
- **Nag≈Çe spadki**: Wykryte straty pakiet√≥w
- **Plateau**: Ograniczenie przez odbiorcƒô (rwnd) lub sieƒá

## Wskaz√≥wki optymalizacji

### Dla d≈Çugotrwa≈Çego monitoringu:
```bash
# U≈ºyj wiƒôkszych interwa≈Ç√≥w przy d≈Çugim czasie
sudo ./run.sh monitor --duration 3600  # 1 godzina
```

### Dla analizy wydajno≈õci:
```bash
# Skup siƒô na po≈ÇƒÖczeniach o wysokim CWND
sudo ./run.sh analyze --min-cwnd 50 --charts
```

### Dla debugowania sieci:
```bash
# Monitoruj konkretne po≈ÇƒÖczenia
sudo ./run.sh live --saddr YOUR_SERVER_IP
```

## Struktura danych wyj≈õciowych

### Format CSV:
```
timestamp,pid,saddr,sport,daddr,dport,cwnd,connection
2025-01-01T12:00:00.123456,1234,192.168.1.1,12345,192.168.1.2,80,42,192.168.1.1:12345->192.168.1.2:80
```

### Kolumny:
- `timestamp`: Czas zdarzenia (ISO format)
- `pid`: ID procesu (0 dla jƒÖdra)
- `saddr`: ≈πr√≥d≈Çowy adres IP
- `sport`: Port ≈∫r√≥d≈Çowy  
- `daddr`: Docelowy adres IP
- `dport`: Port docelowy
- `cwnd`: Warto≈õƒá congestion window
- `connection`: String identyfikujƒÖcy po≈ÇƒÖczenie

## Skr√≥ty klawiszowe w trybie live

- `Ctrl+C`: Zatrzymanie monitoringu
- Program automatycznie przewija wyniki w terminalu

---

## Przyk≈Çad kompletnego workflow

```bash
# 1. Szybka analiza (najprostsze)
sudo ./run.sh quick --duration 60

# 2. Sprawdzenie wynik√≥w  
ls out/session_*/

# 3. Otworzenie interaktywnego wykresu
firefox out/session_*/*_interactive.html

# 4. Dla g≈Çƒôbszej analizy konkretnego procesu
sudo ./run.sh monitor --duration 300
sudo ./run.sh analyze --pid $(pgrep nginx) --charts

# 5. Monitoring na ≈ºywo podczas test√≥w
sudo ./run.sh live &
# Uruchom swoje testy sieciowe
# Ctrl+C aby zatrzymaƒá
```

To narzƒôdzie daje pe≈ÇnƒÖ kontrolƒô nad monitoringiem TCP CWND z elastycznymi opcjami analizy i wizualizacji!
